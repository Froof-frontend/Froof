# lefthook.yml

# pre-commit: 'git commit' 명령어를 입력했을 때, 실제 커밋이 기록되기 직전에 실행됩니다.
pre-commit:
  # 여러 개의 command를 동시에 실행하여 속도를 높입니다.
  parallel: true
  commands:
    # 1. Biome 체크 (Lint + Format 통합)
    # ESLint와 Prettier의 역할을 Biome 하나로 합쳐서 처리합니다.
    biome-check:
      # 검사할 대상 파일 확장자를 지정합니다.
      glob: "*.{js,jsx,ts,tsx,json,jsonc}"
      # --write: 안전한 수정 사항(포맷팅 등)을 자동으로 적용합니다.
      # --no-errors-on-unmatched: 대상 파일이 없어도 에러를 내지 않고 넘어갑니다.
      # {staged_files}: 현재 git add 되어 있는 파일들만 골라서 검사합니다.
      run: npx @biomejs/biome check --write --no-errors-on-unmatched {staged_files}
      # Biome이 파일을 수정했을 경우, 수정된 내용을 다시 스테이징(git add) 상태로 만듭니다.
      stage_fixed: true

    # 2. TypeScript 타입 체크
    # 타입 오류는 수정한 파일 외에 다른 파일에도 영향을 줄 수 있으므로 프로젝트 전체를 검사합니다.
    # Biome은 아직 정적 타입 체크(tsc의 역할)까지는 대신하지 못하므로 별도로 유지합니다.
    type-check:
      run: npx tsc --noEmit
